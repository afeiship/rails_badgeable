### Rails Badgeable API Tests
@baseUrl = http://localhost:3000/api
@contentType = application/json

###############################################################################
# Badges CRUD (Independent Management)
###############################################################################

### List all badges
GET {{baseUrl}}/badges

### Create badge 1
POST {{baseUrl}}/badges
Content-Type: {{contentType}}

{
  "name": "Important",
  "description": "Important content marker"
}

### Create badge 2
POST {{baseUrl}}/badges
Content-Type: {{contentType}}

{
  "name": "Featured",
  "description": "Featured content"
}

### Create badge 3
POST {{baseUrl}}/badges
Content-Type: {{contentType}}

{
  "name": "Archived",
  "description": "Archived content"
}

### Get a specific badge
GET {{baseUrl}}/badges/1

### Update a badge
PUT {{baseUrl}}/badges/1
Content-Type: {{contentType}}

{
  "name": "Very Important",
  "description": "Critical content"
}

### Get all posts assigned to this badge
GET {{baseUrl}}/badges/1/assigned_to?model_type=Post

### Delete a badge
DELETE {{baseUrl}}/badges/3

###############################################################################
# Posts CRUD with badge_ids
###############################################################################

### List all posts
GET {{baseUrl}}/posts

### Create a post with badges (using badge_ids array)
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
  "title": "Hello World",
  "content": "My first post",
  "badge_ids": [1, 2]
}

### Create another post without badges
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
  "title": "Rails is awesome",
  "content": "Learning Rails engines"
}

### Get a specific post (includes badges)
GET {{baseUrl}}/posts/1

### Update a post with new badge_ids (replaces all badges)
PUT {{baseUrl}}/posts/2
Content-Type: {{contentType}}

{
  "title": "Rails is awesome - Updated",
  "content": "Updated content",
  "badge_ids": [1]
}

### Update a post - remove all badges (empty array)
PUT {{baseUrl}}/posts/1
Content-Type: {{contentType}}

{
  "title": "Hello World - Updated",
  "content": "Updated content",
  "badge_ids": []
}

### Update a post - don't change badges (omit badge_ids)
PUT {{baseUrl}}/posts/2
Content-Type: {{contentType}}

{
  "title": "Rails is awesome - Final",
  "content": "Final content"
}

### Delete a post
DELETE {{baseUrl}}/posts/2

###############################################################################
# Post Badge Individual Operations (Optional - for fine-grained control)
###############################################################################

### Get badges for a post
GET {{baseUrl}}/posts/1/badges

### Add a single badge to a post
POST {{baseUrl}}/posts/1/badges?badge_id=3

### Remove a single badge from a post
DELETE {{baseUrl}}/posts/1/badges/1

###############################################################################
# Workflow Example - Complete Scenario
###############################################################################

### Step 1: Create badges first
POST {{baseUrl}}/badges
Content-Type: {{contentType}}

{
  "name": "Priority",
  "description": "High priority item"
}

### Step 2: Create another badge
POST {{baseUrl}}/badges
Content-Type: {{contentType}}

{
  "name": "Urgent",
  "description": "Urgent action required"
}

### Step 3: Create post with multiple badges
POST {{baseUrl}}/posts
Content-Type: {{contentType}}

{
  "title": "Project Update",
  "content": "Weekly progress report",
  "badge_ids": [4, 5]
}

### Step 4: Check post's badges (should have 2 badges)
GET {{baseUrl}}/posts/1

### Step 5: Update post - keep only Priority badge
PUT {{baseUrl}}/posts/1
Content-Type: {{contentType}}

{
  "title": "Project Update - Revised",
  "content": "Updated report",
  "badge_ids": [4]
}

### Step 6: Check which posts have Priority badge
GET {{baseUrl}}/badges/4/assigned_to?model_type=Post

### Step 7: Remove all badges from post
PUT {{baseUrl}}/posts/1
Content-Type: {{contentType}}

{
  "title": "Project Update - Final",
  "content": "Final report",
  "badge_ids": []
}
